<!doctype html><html lang=en><head><title>Buy vs. Rent, A Financial Modeling Workflow in Python</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet href=../../css/theme.min.css><style>table{display:block;max-width:-moz-fit-content;max-width:fit-content;margin:0 auto;overflow-x:auto;white-space:nowrap;text-align:left;color:#000}.dataframe{font-size:85%;border-collapse:collapse;width:100%}.dataframe thead th{text-align:center!important}.dataframe td,.dataframe th{border:1px solid #ddd;padding:8px}.dataframe tbody tr{padding:.5em;border:1px solid #afafaf}.dataframe tbody tr:nth-child(even){background-color:#f2f2f2}.dataframe tr:hover{background-color:#ddd}.dataframe tbody tr th{padding:.5em}.dataframe th{background-color:#dfdfdf}</style></head><body><div id=content class=mx-auto><header class="container mt-sm-5 mt-4 mb-4 mt-xs-1"><div class=row><div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4"><a href=../../ class=text-decoration-none><img id=home-image class=rounded-circle src=../../images/Peter_Amerkhanian_Headshot_square_lower_qual.jpg></a></div><div class="col-sm-8 col-12 text-sm-left text-center"><h2 class="m-0 mb-2 mt-4"><a href=../../ class=text-decoration-none>Peter Amerkhanian</a></h2><p class="text-muted mb-1">MPP '23 @ UC Berkeley Goldman School</p><ul id=nav-links class="list-inline mb-2"><li class=list-inline-item><a class="badge badge-white" href=../../ title=About>About</a></li><li class=list-inline-item><a class="badge badge-white" href=../../post/ title=Blog>Blog</a></li></ul><ul id=nav-social class=list-inline><li class="list-inline-item mr-3"><a href=mailto:peteramerkhanian@berkeley.edu target=_blank><i class="fas fa-at fa-lg text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=https://www.linkedin.com/in/peteramerkhanian/ target=_blank><i class="fab fa-linkedin-in fa-lg text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=https://github.com/peter-amerkhanian target=_blank><i class="fab fa-github fa-lg text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=https://peter-amerkhanian.github.io/documents/Amerkhanian_Peter_Resume_6_2022.pdf target=_blank><i class="fas fa-file-alt fa-lg text-muted"></i></a></li></ul></div></div><hr></header><div class=container><div class=pl-sm-2><div class=mb-3><h3 class=mb-0>Buy vs. Rent, A Financial Modeling Workflow in Python</h3><small class=text-muted>Published August 6, 2022</small></div><article><h3 id=summary>Summary</h3><p>This post goes through the following exercises:</p><ul><li>Use <code>numpy-financial</code> to build a <a href=https://en.wikipedia.org/wiki/Amortization_calculator>loan amortization calculator</a> for a home mortgage</li><li>Use said table as well as simulated home and stock equity returns over time to compare year-to-year wealth resulting from the following strategies:<ul><li>1.) buying a residential living space</li><li>2.) renting one instead and investing the dollar amount that would have been your down-payment</li></ul></li></ul><h3 id=a-note-on-numpy-financial>A Note on <code>numpy-financial</code></h3><p>At one point in time, <code>numpy</code>, the popular Python numerical analysis library, included 10 specialized functions for financial analysis. Given their specific nature, they were eventually removed from <code>numpy</code>, I think in 2019 (<a href=https://numpy.org/neps/nep-0032-remove-financial-functions.html>learn about why that is here</a>) and are now available in the separate library, <code>numpy-financial</code>. The library still seems focused on the same <a href=https://numpy.org/numpy-financial/latest/>10 core functions</a>, which handle tasks like calculating loan payment amounts given some inputs, and applied financial economics tasks like calculating time value of money. Cool&mldr; Anyways, I&rsquo;ll use it to create an amortization schedule for a mortgage.</p><h3 id=environmentpackages>Environment/Packages</h3><p>I built this notebook in a Google Colab instance, which seems to include most major Python libraries (<a href=https://stackoverflow.com/questions/47109539/what-are-the-available-libraries-within-google-colaboratory>more info</a>).</p><p>You&rsquo;ll probably have to download <code>numpy-financial</code> (it&rsquo;s not included in Anaconda as far as I know), which you can accomplish within any notebook-like environment using the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!pip install numpy<span style=color:#ff79c6>-</span>financial
</span></span></code></pre></div><pre><code>Requirement already satisfied: numpy-financial in c:\users\peteramerkhanian\anaconda3\lib\site-packages (1.0.0)
Requirement already satisfied: numpy&gt;=1.15 in c:\users\peteramerkhanian\anaconda3\lib\site-packages (from numpy-financial) (1.20.1)
</code></pre><p>You&rsquo;ll want to load the usual suspects - <code>pandas</code>, <code>numpy</code>, <code>seaborn</code>, <code>matplotlib</code>. I also run <code>from datetime import datetime</code> since we will be working with ranges of dates, and I run <code>sns.set_style()</code> to get my seaborn plots looking a bit more aesthetically pleasing - read more on themes <a href=https://seaborn.pydata.org/generated/seaborn.set_theme.html#seaborn.set_theme>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>import</span> pandas <span style=color:#ff79c6>as</span> pd
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> numpy <span style=color:#ff79c6>as</span> np
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> numpy_financial <span style=color:#ff79c6>as</span> npf
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> datetime <span style=color:#ff79c6>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> seaborn <span style=color:#ff79c6>as</span> sns
</span></span><span style=display:flex><span><span style=color:#6272a4># set seaborn style</span>
</span></span><span style=display:flex><span>sns<span style=color:#ff79c6>.</span>set_style(<span style=color:#f1fa8c>&#34;white&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> matplotlib.pyplot <span style=color:#ff79c6>as</span> plt
</span></span><span style=display:flex><span><span style=color:#6272a4># Set Matplotlib font size</span>
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>rcParams<span style=color:#ff79c6>.</span>update({<span style=color:#f1fa8c>&#39;font.size&#39;</span>: <span style=color:#bd93f9>14</span>})
</span></span></code></pre></div><h3 id=definining-constants>Definining Constants</h3><p>I&rsquo;ll run this as a comparison between buying an apartment that costs $<b></b>700,000 with a 20% downpayment, versus renting a home for $2,600 a month. This is meant to approximate buying versus renting a two-bed one-bath apartment.</p><p>Buying fees are defined at 4%, the homeowners association fees are defined as $700 monthly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Buying Constants</span>
</span></span><span style=display:flex><span>interest_rate <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0.065</span>
</span></span><span style=display:flex><span>cost <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>700000</span>
</span></span><span style=display:flex><span>hoa <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>700</span>
</span></span><span style=display:flex><span>down_payment <span style=color:#ff79c6>=</span> cost <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>.2</span>
</span></span><span style=display:flex><span>principal <span style=color:#ff79c6>=</span> cost <span style=color:#ff79c6>-</span> down_payment
</span></span><span style=display:flex><span>buying_fees <span style=color:#ff79c6>=</span> principal<span style=color:#ff79c6>*</span><span style=color:#bd93f9>.04</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Renting Constants</span>
</span></span><span style=display:flex><span>rent <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2600</span>
</span></span></code></pre></div><p><code>npf.pmt()</code> can be used to generate a monthly mortgage payment given those buying constants:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>npf<span style=color:#ff79c6>.</span>pmt(interest_rate<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>, principal)
</span></span></code></pre></div><pre><code>-3539.580931560606
</code></pre><p>alternatively, we can use <code>npf.ppt()</code> to see how much of the payment goes towards the principal, and use <code>npf.ipmt()</code> to see how much goes towards interest (see below for applications of those functions).</p><h3 id=defining-random-variables>Defining Random Variables</h3><p>I&rsquo;ll make the simplifying assumption that both &ldquo;annual home appreciation&rdquo; and &ldquo;annual stock appreciation&rdquo; are generated from normal distributions. This is a kind of strong assumption, but one that seems to be routinely made at least with regards to stock market returns, even if there might be better distribution choices out there (<a href=https://arxiv.org/ftp/arxiv/papers/1906/1906.10325.pdf>more here</a>). I could alternatively get historical data for these variables (yahoo finance has historical stock data, Zillow&rsquo;s ZHVI index has home appreciation for the past 20 years) and use <a href=https://en.wikipedia.org/wiki/Bootstrapping_(statistics)>the bootstrap</a> to approximate the true sampling distribution for each, but we&rsquo;ll just use normal distributions and keep this as more of a back-of-the-envelope calculator for now.</p><p>Here&rsquo;s a look at how we&rsquo;ll draw from a normal distribution. Given an average annual return, $\mu = 0.0572$ ($\mu$, or, mu, is a common variable name for average) and a standard deviation $\sigma = 0.1042$ ($\sigma$, or, sigma, is the common variable name for standard deviation), we can draw one sample from a normal distribution as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Set a random seed for stability of results</span>
</span></span><span style=display:flex><span>np<span style=color:#ff79c6>.</span>random<span style=color:#ff79c6>.</span>seed(<span style=color:#bd93f9>30</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mean <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.0572</span>
</span></span><span style=display:flex><span>standard_deviation <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.1042</span>
</span></span><span style=display:flex><span>samples <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Draw the sample</span>
</span></span><span style=display:flex><span>np<span style=color:#ff79c6>.</span>random<span style=color:#ff79c6>.</span>normal(mean, standard_deviation, samples)
</span></span></code></pre></div><pre><code>array([-0.07451429])
</code></pre><p>We now simulate market returns for every month by supplying mean and standard deviation values for both home and stock market appreciation and drawing 360 samples (360 months in 30 years). For simplicity, we&rsquo;ll just use world-wide aggregate values from <a href=https://www.frbsf.org/economic-research/wp-content/uploads/sites/4/wp2017-25.pdf>&ldquo;The Rate of Return on Everything, 1870-2015&rdquo;</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>mu_stock <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.1081</span>
</span></span><span style=display:flex><span>sigma_stock <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.2267</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mu_home <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.0572</span>
</span></span><span style=display:flex><span>sigma_home <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>.1042</span>
</span></span></code></pre></div><p>Given that stock and home appreciation is probably correlated, I&rsquo;ll have ti sample from a bivariate normal distribution using <code>numpy.random.Generator.multivariate_normal</code> - documentation <a href=https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html>here</a>, rather than the univariate distribution draw shown above. I am going to assume a correlation coefficient, $\rho_{stock,home}$ of 0.5 - a fairly clear correlation.<br>In order to use that numpy function, I&rsquo;ll need to translate my correlation statistic into a covariance statistic, and I&rsquo;ll use the following formula (<a href=https://en.wikipedia.org/wiki/Correlation>source</a>):<br>$$ \begin{align*}
cov_{stock,home} &= \rho_{stock,home} \times \sigma_{stock} \sigma_{home} \\
cov_{stock,home} &= 0.5 \times .2267 \times .1042 \end{align*} $$</p><p>I calculate covariance and confirm that the covariance and correlations match up below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>cov <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0.5</span> <span style=color:#ff79c6>*</span> sigma_stock <span style=color:#ff79c6>*</span> sigma_home
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Covariance:&#34;</span>, cov)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Back to correlation:&#34;</span>, cov <span style=color:#ff79c6>/</span> (sigma_stock <span style=color:#ff79c6>*</span> sigma_home))
</span></span></code></pre></div><pre><code>Covariance: 0.01181107
Back to correlation: 0.5
</code></pre><p>Now that I have the covariance, I&rsquo;ll be able to sample from a bivariate normal distribution of the form shown below (<a href=https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Bivariate_case_2>source</a>).<br>$$ \begin{pmatrix} Stock \\ Home\end{pmatrix} \sim \mathcal{N} \left[ \begin{pmatrix} \mu_{s} \\ \mu_{h}\end{pmatrix}, \begin{pmatrix} \sigma_{s}^2 & cov_{s,h} \\ cov_{s,h} & \sigma_{h}^2\end{pmatrix} \right]$$
<em>Note, $s$ is shorthand for stock and $h$ is shorthand for home.</em></p><p>Now I&rsquo;ll code that in Python and confirm that the means and standard deviations of our samples match what we expect:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>cov_matrix <span style=color:#ff79c6>=</span> [[sigma_stock<span style=color:#ff79c6>**</span><span style=color:#bd93f9>2</span>, cov],
</span></span><span style=display:flex><span>              [cov, sigma_home<span style=color:#ff79c6>**</span><span style=color:#bd93f9>2</span>]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>returns_df <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>DataFrame(np<span style=color:#ff79c6>.</span>random
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>default_rng(<span style=color:#bd93f9>30</span>)
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>multivariate_normal([mu_stock, mu_home],
</span></span><span style=display:flex><span>                                               cov_matrix,
</span></span><span style=display:flex><span>                                               <span style=color:#bd93f9>1</span>)   ,
</span></span><span style=display:flex><span>                          columns<span style=color:#ff79c6>=</span>[<span style=color:#f1fa8c>&#34;Stock_Appreciation&#34;</span>, <span style=color:#f1fa8c>&#34;Home_Appreciation&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Means:&#34;</span>, returns_df<span style=color:#ff79c6>.</span>mean(axis<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>)<span style=color:#ff79c6>.</span>values)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;Std. Devs:&#34;</span>, returns_df<span style=color:#ff79c6>.</span>std(axis<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>)<span style=color:#ff79c6>.</span>values)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>returns_df <span style=color:#ff79c6>=</span> (returns_df <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>12</span>)
</span></span></code></pre></div><pre><code>Means: [0.10764063 0.05970695]
Std. Devs: [0.22544095 0.10543034]
</code></pre><p>Plotting the simulated values, we can see that stock market returns are typically higher than home value appreciation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>returns_df<span style=color:#ff79c6>.</span>cumsum()<span style=color:#ff79c6>.</span>plot(figsize<span style=color:#ff79c6>=</span>(<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>5</span>))
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>xlabel(<span style=color:#f1fa8c>&#34;Months&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>ylabel(<span style=color:#f1fa8c>&#34;Money Multiplier&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>title(<span style=color:#f1fa8c>&#34;Simulated Home/Stock Returns&#34;</span>)
</span></span><span style=display:flex><span>sns<span style=color:#ff79c6>.</span>despine();
</span></span></code></pre></div><p><img src=images/output_18_0.png alt=png_one></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>home_performance <span style=color:#ff79c6>=</span> returns_df<span style=color:#ff79c6>.</span>cumsum()[<span style=color:#f1fa8c>&#39;Home_Appreciation&#39;</span>] <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>stock_performance <span style=color:#ff79c6>=</span> returns_df<span style=color:#ff79c6>.</span>cumsum()[<span style=color:#f1fa8c>&#39;Stock_Appreciation&#39;</span>] <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</span></span></code></pre></div><p>Now we can define two spread-sheet-like dataframes:</p><ul><li>one that shows a mortgage amortization schedule for if you were to buy the $600,000 home, along with the home&rsquo;s appreciation over time.</li><li>one that shows a table of rent payments and the stock market growth of what would have been your down payment (you can invest the down payment since you didn&rsquo;t end up purchasing a house).</li></ul><h3 id=ownership-table>Ownership Table</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Buying Table</span>
</span></span><span style=display:flex><span>df_own <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>DataFrame()
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Period&#34;</span>] <span style=color:#ff79c6>=</span>  pd<span style=color:#ff79c6>.</span>Series(<span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>)) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Date&#34;</span>] <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>date_range(start<span style=color:#ff79c6>=</span>datetime<span style=color:#ff79c6>.</span>today(),
</span></span><span style=display:flex><span>                           periods<span style=color:#ff79c6>=</span><span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>,
</span></span><span style=display:flex><span>                           freq<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;MS&#39;</span>,
</span></span><span style=display:flex><span>                           name<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Date&#34;</span>)
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Principal_Paid&#34;</span>] <span style=color:#ff79c6>=</span> npf<span style=color:#ff79c6>.</span>ppmt(interest_rate<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>,
</span></span><span style=display:flex><span>                                    df_own[<span style=color:#f1fa8c>&#34;Period&#34;</span>],
</span></span><span style=display:flex><span>                                    <span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>,
</span></span><span style=display:flex><span>                                    principal)
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Interest_Paid&#34;</span>] <span style=color:#ff79c6>=</span> npf<span style=color:#ff79c6>.</span>ipmt(interest_rate<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>,
</span></span><span style=display:flex><span>                                   df_own[<span style=color:#f1fa8c>&#34;Period&#34;</span>],
</span></span><span style=display:flex><span>                                   <span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>,
</span></span><span style=display:flex><span>                                   principal)
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;HOA_Paid&#34;</span>] <span style=color:#ff79c6>=</span> hoa
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;HOA_Paid&#34;</span>] <span style=color:#ff79c6>=</span> df_own[<span style=color:#f1fa8c>&#34;HOA_Paid&#34;</span>]<span style=color:#ff79c6>.</span>cumsum()
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Balance_Remaining&#34;</span>] <span style=color:#ff79c6>=</span> principal <span style=color:#ff79c6>+</span> df_own[<span style=color:#f1fa8c>&#34;Principal_Paid&#34;</span>]<span style=color:#ff79c6>.</span>cumsum()
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Home_Value&#34;</span>] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>round</span>(cost <span style=color:#ff79c6>*</span> home_performance, <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;PropTax_Paid&#34;</span>] <span style=color:#ff79c6>=</span> (df_own[<span style=color:#f1fa8c>&#34;Period&#34;</span>]
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>apply(<span style=color:#ff79c6>lambda</span> x:
</span></span><span style=display:flex><span>                                 (cost <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>1.02</span><span style=color:#ff79c6>**</span>((x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0.01</span>)
</span></span><span style=display:flex><span>                                 <span style=color:#ff79c6>if</span> (x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>list</span>(<span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>1000</span>, <span style=color:#bd93f9>12</span>))
</span></span><span style=display:flex><span>                                 <span style=color:#ff79c6>else</span> <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>cumsum())
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Sale_Fees&#34;</span>] <span style=color:#ff79c6>=</span> df_own[<span style=color:#f1fa8c>&#34;Home_Value&#34;</span>] <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>.07</span>
</span></span><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;Own_Profit&#34;</span>] <span style=color:#ff79c6>=</span> (df_own[<span style=color:#f1fa8c>&#34;Home_Value&#34;</span>] <span style=color:#ff79c6>-</span>
</span></span><span style=display:flex><span>                              df_own[<span style=color:#f1fa8c>&#34;HOA_Paid&#34;</span>] <span style=color:#ff79c6>-</span>
</span></span><span style=display:flex><span>                              df_own[<span style=color:#f1fa8c>&#34;Balance_Remaining&#34;</span>] <span style=color:#ff79c6>-</span>
</span></span><span style=display:flex><span>                              (buying_fees <span style=color:#ff79c6>+</span> df_own[<span style=color:#f1fa8c>&#34;Sale_Fees&#34;</span>]) <span style=color:#ff79c6>-</span>
</span></span><span style=display:flex><span>                              df_own[<span style=color:#f1fa8c>&#34;PropTax_Paid&#34;</span>])
</span></span><span style=display:flex><span>df_own <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>round</span>(df_own, <span style=color:#bd93f9>2</span>)
</span></span></code></pre></div><p>Note this code, which is a bit of a monster:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_own[<span style=color:#f1fa8c>&#34;PropTax_Paid&#34;</span>] <span style=color:#ff79c6>=</span> (df_own[<span style=color:#f1fa8c>&#34;Period&#34;</span>]
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>apply(<span style=color:#ff79c6>lambda</span> x:
</span></span><span style=display:flex><span>                                 (cost <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>1.02</span><span style=color:#ff79c6>**</span>((x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>)<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0.01</span>)
</span></span><span style=display:flex><span>                                 <span style=color:#ff79c6>if</span> (x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>list</span>(<span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>1000</span>, <span style=color:#bd93f9>12</span>))
</span></span><span style=display:flex><span>                                 <span style=color:#ff79c6>else</span> <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>                          <span style=color:#ff79c6>.</span>cumsum())
</span></span></code></pre></div><p>What is happening here is a calculation of property assessed value and property tax according to California&rsquo;s property assessment/tax regime (<a href=https://www.boe.ca.gov/proptaxes/pdf/pub29.pdf>more here)</a>. We&rsquo;ll look at this in two pieces, first, assessed value. In California, once you purchase a property, its assessed value is set at the purchase price, then increases annually by the lower of 2% or the rate of inflation according to the California Consumer Price Index (CCPI). You could write out an equation for this as follows:
$$ \begin{align*}
AnnualFactor_y =
\begin{cases}
1 + CCPI_y, & \text{if } CCPI_y &lt; 0.02 \\
1.02, & \text{otherwise}
\end{cases}
\end{align*} $$
$AnnualFactor$ is the amount that the assessed value of a home will appreciate (expressed as a multiplier) in a given year, $y$. We define $y^*$ as the year of initial purchase and
$PurchasePrice$ as the amount that the home was purchased for. Given that, $AssessedValue$ is defined as follows:</p><p>$$ \begin{align*}
AssessedValue_y =
\begin{cases}
PurchasePrice, & \text{if } y = y^* \\
AssessedValue_{y-1} \times AnnualFactor_y, & \text{otherwise }
\end{cases}
\end{align*} $$
In our code, we will simplify this calculation by excluding the CCPI and just always using 1.02 as our annual factor. Therefore, we get:</p><p>$$ \begin{align*}
AssessedValue_y = PurchasePrice \times 1.02^y
\end{align*} $$</p><p>and once we factor in taxes (1%), we get:<br>$$
\begin{equation*}
PropertyTax_y = 0.01(PurchasePrice \times 1.02^y)
\end{equation*}
$$
and finally we look at the the cumulative total property tax you&rsquo;ve paid in a given year $y$, which is <code>df_own["PropTax_Paid"] </code>:
$$
\begin{equation*}
PropertyTaxPaid_y = \sum_{y=1}^{30} 0.01(PurchasePrice \times 1.02^y)
\end{equation*}
$$
There&rsquo;s some elements added to the code to work between years and months, but that equation is the gist of it.<br>We end up with the following table for property ownership:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_own
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Period</th><th>Date</th><th>Principal_Paid</th><th>Interest_Paid</th><th>HOA_Paid</th><th>Balance_Remaining</th><th>Home_Value</th><th>PropTax_Paid</th><th>Sale_Fees</th><th>Own_Profit</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2022-09-01 14:11:08.272596</td><td>-506.25</td><td>-3033.33</td><td>700</td><td>559493.75</td><td>701405.73</td><td>7000.00</td><td>49098.40</td><td>62713.58</td></tr><tr><th>1</th><td>2</td><td>2022-10-01 14:11:08.272596</td><td>-508.99</td><td>-3030.59</td><td>1400</td><td>558984.76</td><td>707143.89</td><td>7000.00</td><td>49500.07</td><td>67859.06</td></tr><tr><th>2</th><td>3</td><td>2022-11-01 14:11:08.272596</td><td>-511.75</td><td>-3027.83</td><td>2100</td><td>558473.02</td><td>723148.91</td><td>7000.00</td><td>50620.42</td><td>82555.47</td></tr><tr><th>3</th><td>4</td><td>2022-12-01 14:11:08.272596</td><td>-514.52</td><td>-3025.06</td><td>2800</td><td>557958.50</td><td>736621.91</td><td>7000.00</td><td>51563.53</td><td>94899.88</td></tr><tr><th>4</th><td>5</td><td>2023-01-01 14:11:08.272596</td><td>-517.31</td><td>-3022.28</td><td>3500</td><td>557441.19</td><td>744559.68</td><td>7000.00</td><td>52119.18</td><td>102099.31</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>355</th><td>356</td><td>2052-04-01 14:11:08.272596</td><td>-3445.26</td><td>-94.33</td><td>249200</td><td>13968.65</td><td>1937424.41</td><td>283976.55</td><td>135619.71</td><td>1232259.49</td></tr><tr><th>356</th><td>357</td><td>2052-05-01 14:11:08.272596</td><td>-3463.92</td><td>-75.66</td><td>249900</td><td>10504.74</td><td>1940547.12</td><td>283976.55</td><td>135838.30</td><td>1237927.53</td></tr><tr><th>357</th><td>358</td><td>2052-06-01 14:11:08.272596</td><td>-3482.68</td><td>-56.90</td><td>250600</td><td>7022.06</td><td>1944357.20</td><td>283976.55</td><td>136105.00</td><td>1244253.59</td></tr><tr><th>358</th><td>359</td><td>2052-07-01 14:11:08.272596</td><td>-3501.54</td><td>-38.04</td><td>251300</td><td>3520.51</td><td>1949518.54</td><td>283976.55</td><td>136466.30</td><td>1251855.18</td></tr><tr><th>359</th><td>360</td><td>2052-08-01 14:11:08.272596</td><td>-3520.51</td><td>-19.07</td><td>252000</td><td>-0.00</td><td>1953845.89</td><td>283976.55</td><td>136769.21</td><td>1258700.12</td></tr></tbody></table><p>360 rows × 10 columns</p></div><h3 id=rental-table>Rental Table</h3><p>This one is a but more simple, only examining the total rent you&rsquo;ve paid in a given month and simulated stock returns at that point.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Rental Table</span>
</span></span><span style=display:flex><span>df_rent <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>DataFrame()
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;Period&#34;</span>] <span style=color:#ff79c6>=</span>  pd<span style=color:#ff79c6>.</span>Series(<span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>)) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;Date&#34;</span>] <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>date_range(start<span style=color:#ff79c6>=</span>datetime<span style=color:#ff79c6>.</span>today(),
</span></span><span style=display:flex><span>                           periods<span style=color:#ff79c6>=</span><span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>30</span>,
</span></span><span style=display:flex><span>                           freq<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;MS&#39;</span>,
</span></span><span style=display:flex><span>                           name<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Date&#34;</span>)
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;DownPayment_Invested&#34;</span>] <span style=color:#ff79c6>=</span>  stock_performance <span style=color:#ff79c6>*</span> down_payment
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;Rent_Paid&#34;</span>] <span style=color:#ff79c6>=</span> rent
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;Rent_Paid&#34;</span>] <span style=color:#ff79c6>=</span> df_rent[<span style=color:#f1fa8c>&#34;Rent_Paid&#34;</span>]<span style=color:#ff79c6>.</span>cumsum()
</span></span><span style=display:flex><span>df_rent[<span style=color:#f1fa8c>&#34;Rent_Profit&#34;</span>] <span style=color:#ff79c6>=</span> df_rent[<span style=color:#f1fa8c>&#34;DownPayment_Invested&#34;</span>] <span style=color:#ff79c6>-</span> df_rent[<span style=color:#f1fa8c>&#34;Rent_Paid&#34;</span>]
</span></span><span style=display:flex><span>df_rent <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>round</span>(df_rent, <span style=color:#bd93f9>2</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_rent
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>Period</th><th>Date</th><th>DownPayment_Invested</th><th>Rent_Paid</th><th>Rent_Profit</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>2022-09-01 14:11:08.352336</td><td>136919.68</td><td>2600</td><td>134319.68</td></tr><tr><th>1</th><td>2</td><td>2022-10-01 14:11:08.352336</td><td>140789.47</td><td>5200</td><td>135589.47</td></tr><tr><th>2</th><td>3</td><td>2022-11-01 14:11:08.352336</td><td>142175.79</td><td>7800</td><td>134375.79</td></tr><tr><th>3</th><td>4</td><td>2022-12-01 14:11:08.352336</td><td>145552.44</td><td>10400</td><td>135152.44</td></tr><tr><th>4</th><td>5</td><td>2023-01-01 14:11:08.352336</td><td>146217.26</td><td>13000</td><td>133217.26</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>355</th><td>356</td><td>2052-04-01 14:11:08.352336</td><td>594635.22</td><td>925600</td><td>-330964.78</td></tr><tr><th>356</th><td>357</td><td>2052-05-01 14:11:08.352336</td><td>591339.68</td><td>928200</td><td>-336860.32</td></tr><tr><th>357</th><td>358</td><td>2052-06-01 14:11:08.352336</td><td>589319.15</td><td>930800</td><td>-341480.85</td></tr><tr><th>358</th><td>359</td><td>2052-07-01 14:11:08.352336</td><td>588221.21</td><td>933400</td><td>-345178.79</td></tr><tr><th>359</th><td>360</td><td>2052-08-01 14:11:08.352336</td><td>592090.64</td><td>936000</td><td>-343909.36</td></tr></tbody></table><p>360 rows × 5 columns</p></div><h3 id=results>Results</h3><p>At this point, I&rsquo;ll merge the ownership and rental tables and plot out what happened in this simulation</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>merged <span style=color:#ff79c6>=</span> pd<span style=color:#ff79c6>.</span>merge(df_own, df_rent, on<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Period&#34;</span>)
</span></span><span style=display:flex><span>merged <span style=color:#ff79c6>=</span> merged<span style=color:#ff79c6>.</span>melt(value_vars <span style=color:#ff79c6>=</span> [<span style=color:#f1fa8c>&#34;Rent_Profit&#34;</span>, <span style=color:#f1fa8c>&#34;Own_Profit&#34;</span>], id_vars<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;Period&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>figure(figsize<span style=color:#ff79c6>=</span>(<span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>6</span>))
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>title(<span style=color:#f1fa8c>&#34;Wealth Outcomes for Owning vs. Renting a 2b1br Apt&#34;</span>)
</span></span><span style=display:flex><span>sns<span style=color:#ff79c6>.</span>lineplot(data<span style=color:#ff79c6>=</span>merged, x<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Period&#34;</span>, y<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;value&#34;</span>, hue<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;variable&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>350</span>, <span style=color:#bd93f9>12</span>):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> x <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>:
</span></span><span style=display:flex><span>        plt<span style=color:#ff79c6>.</span>axvline(x, color<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;grey&#34;</span>, linestyle<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;:&#34;</span>, alpha<span style=color:#ff79c6>=</span><span style=color:#bd93f9>1</span>, label<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Year&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span>:
</span></span><span style=display:flex><span>        plt<span style=color:#ff79c6>.</span>axvline(x, color<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;grey&#34;</span>, linestyle<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;:&#34;</span>, alpha<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0.7</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#ff79c6>.</span>text(x<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>100000</span>, <span style=color:#8be9fd;font-style:italic>str</span>(<span style=color:#8be9fd;font-style:italic>int</span>(x<span style=color:#ff79c6>/</span><span style=color:#bd93f9>12</span>)), alpha<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0.8</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>axhline(<span style=color:#bd93f9>0</span>, color<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;red&#34;</span>, linestyle<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;--&#34;</span>, alpha<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0.5</span>, label<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Zero&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff79c6>.</span>legend()
</span></span><span style=display:flex><span>sns<span style=color:#ff79c6>.</span>despine()
</span></span></code></pre></div><p><img src=images/output_29_0.png alt=png_two></p><p>We can quickly see that ownership will clearly build more wealth in the medium and long run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>years <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>5</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Owner after </span><span style=color:#f1fa8c>{</span>years<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> years:&#34;</span>, df_own<span style=color:#ff79c6>.</span>loc[<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span>years<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#f1fa8c>&#34;Own_Profit&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Renter after </span><span style=color:#f1fa8c>{</span>years<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> years:&#34;</span>, df_rent<span style=color:#ff79c6>.</span>loc[<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span>years<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#f1fa8c>&#34;Rent_Profit&#34;</span>])
</span></span></code></pre></div><pre><code>Owner after 5 years: 215177.81
Renter after 5 years: 40500.11
</code></pre><p>However, we can see that, in the unlikely case that the home is sold within the first year or so, it&rsquo;s the renter that has more wealth, likely due to the owner contending with buying/selling fees:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>years <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Owner after </span><span style=color:#f1fa8c>{</span>years<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> years:&#34;</span>, df_own<span style=color:#ff79c6>.</span>loc[<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span>years<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#f1fa8c>&#34;Own_Profit&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Renter after </span><span style=color:#f1fa8c>{</span>years<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> years:&#34;</span>, df_rent<span style=color:#ff79c6>.</span>loc[<span style=color:#bd93f9>12</span><span style=color:#ff79c6>*</span>years<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, <span style=color:#f1fa8c>&#34;Rent_Profit&#34;</span>])
</span></span></code></pre></div><pre><code>Owner after 1 years: 114027.92
Renter after 1 years: 115865.99
</code></pre><p>A possible takeaway here is that, as long as you can be confident you&rsquo;ll be able to hold onto the house for more than a year, it&rsquo;s probably better to purchase it. Uncertainty estimates would be useful here, and could be obtained by running the simulation under a wide variety of randomly generated market conditions.</p></article></div></div></div><footer class="text-center pb-1"><p></p><p><a href=#content>&uarr;Back to Top&uarr;</a></p><small class=text-muted>&copy; 2022, Peter Amerkhanian<br>Powered by <a href=https://gohugo.io/ target=_blank>Hugo</a>
and <a href=https://github.com/austingebauer/devise target=_blank>Devise</a></small></footer></body></html>